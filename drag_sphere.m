function drag = drag_sphere(reynolds,mach)

    % Drag of a sphere,  as a function of the Reynolds and Mach numbers,
    % with the relationships digitized from p. 15-6 of
    %Hoerner, S.F., 1965, Fluid Dynamic Drag: Vancouver, WA, 
    %  published by the Author.
    % input = Reynods number, Mach number
    % Output = drag coefficient at that Mach number

    if mach<0.5
    %Calculate Cd as a function of Reynolds number, if M<0.5
      if reynolds<20
          drag = (24 / reynolds) * (1 + 0.1315 * reynolds ^ (0.82 - 0.05 * log10(reynolds)));
      elseif reynolds<260
          drag = (24 / reynolds) * (1 + 0.1935 * reynolds ^ 0.6305);
      elseif reynolds < 1500
          drag = 10^(1.6435 - 1.1242 * log10(reynolds) + 0.1558 * log10(reynolds)^2);
      elseif reynolds < 12000
          drag = 10^(-2.4571 + 2.5558 * log10(reynolds) - 0.9295 * log10(reynolds)^2 + 0.1049 * log10(reynolds)^3);
      elseif reynolds < 44000
          drag = 10^(-1.9181 + 0.637 * log10(reynolds) - 0.0636 * log10(reynolds)^2);
      elseif reynolds < 338000
          drag = 10^(-4.339 + 1.5809 * log10(reynolds) - 0.1546 * log10(reynolds)^2);
      elseif reynolds < 400000
          drag = 29.78 - 5.3 * log10(reynolds);
      elseif reynolds < 1000000
          drag = 0.1 * log10(reynolds) - 0.49;
      else
          drag = 0.19 - 80000/reynolds;
      end
    else
      if reynolds < 300000
          %Calculate Cd as a function of Mach number if Re<3.0e+05
          %using data are digitized from Hoerner, 1965
          losphere_Mach=[0.1000,   0.1278,   0.1714,   0.2382,   0.3151, ...
                          0.3728,   0.4140,   0.4897,   0.5364,   0.5834, ...
                          0.6257,   0.6710,   0.7298,   0.7665,   0.7938, ...
                          0.8163,   0.8336,   0.8513,   0.8755,   0.9455, ...
                          0.9792,   1.0141,   1.0876,   1.1996,   1.3606, ...
                          1.5112,   1.7505,   2.0135,   2.2679,   2.6454, ...
                          3.1293,   3.5246,   4.0542,   4.7957,   5.6333, ...
                          9.8610];
          losphere_cd =[0.4953,   0.4953,   0.4953,   0.4828,   0.4828,   ...
                         0.4953,   0.4953,   0.5016,   0.5078,   0.5204,   ...
                         0.5266,   0.5455,   0.5956,   0.6395,   0.6771,   ...
                         0.6771,   0.6646,   0.6207,   0.6207,   0.6708,   ...
                         0.7398,   0.8213,   0.9028,   0.9530,   0.9906,   ...
                         1.0094,   1.0219,   1.0282,   1.0157,   0.9906,   ...
                         0.9655,   0.9467,   0.9342,   0.9342,   0.9342,   ...
                         0.9216];
          %use cubic spline interpolation; set cd=0.9216 for all M>9.861
          drag = interp1d(losphere_Mach,losphere_cd,mach,'cubic');
      else
         %Calculate Cd for M>0.5 when Re>3.0e+05
         %using data are digitized from Hoerner, 1965
         hisphere_Mach=[0.0650,   0.1240,   0.1752,   0.2402,   0.3051, ...
                         0.3642,   0.4311,   0.5020,   0.5610,   0.6122, ...
                         0.6555,   0.6713,   0.6909,   0.7008,   0.7106, ...
                         0.7146,   0.7205,   0.7323,   0.7421,   0.7539, ...
                         0.7736,   0.7933,   0.8228,   0.8445,   0.8740, ...
                         0.8898,   0.9154,   0.9331,   0.9587,   0.9803, ...
                         0.9980,   1.0141,   1.0876,   1.1996,   1.3606, ...
                         1.5112,   1.7505,   2.0135,   2.2679,   2.6454, ...
                         3.1293,   3.5246,   4.0542,   4.7957,   5.6333, ...
                         9.8610];
         hisphere_cd=[ 0.1076,   0.1076,   0.1076,   0.1076,   0.1076, ...
                         0.1116,   0.1195,   0.1315,   0.1474,   0.1673, ...
                         0.1952,   0.2191,   0.2709,   0.3307,   0.4263, ...
                         0.4861,   0.5697,   0.6375,   0.6693,   0.6853, ...
                         0.6853,   0.6693,   0.6255,   0.6175,   0.6215, ...
                         0.6454,   0.6932,   0.7251,   0.7689,   0.8088, ...
                         0.8367,   0.8213,   0.9028,   0.9530,   0.9906, ...
                         1.0094,   1.0219,   1.0282,   1.0157,   0.9906, ...
                         0.9655,   0.9467,   0.9342,   0.9342,   0.9342, ...
                         0.9216];           
         %interpolate to get cd.  If mach>9.8,cd=0.92
         drag = interp1(hisphere_Mach,hisphere_cd,mach,'pchip');
      end
    end

end
    
